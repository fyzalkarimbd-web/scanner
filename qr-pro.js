let currentQrType="url";function openQrModal(){"function"==typeof setActiveMode&&setActiveMode("mode-qr-gen");let e=document.getElementById("qrModal");e?(e.style.display="flex",document.body.style.overflow="hidden",setTimeout(generateAdvancedQR,100)):alert("Modal ID 'qrModal' not found in HTML!")}function closeQrModal(){document.getElementById("qrModal").style.display="none",document.body.style.overflow="auto"}function switchQrType(e,t){currentQrType=e,document.querySelectorAll(".dt-tab").forEach(e=>e.classList.remove("active")),t.classList.add("active"),document.getElementById("qr-url-group").style.display="url"===e?"block":"none",document.getElementById("qr-text-group").style.display="text"===e?"block":"none",document.getElementById("qr-wifi-group").style.display="wifi"===e?"block":"none",document.getElementById("qr-email-group").style.display="email"===e?"block":"none",generateAdvancedQR()}function generateAdvancedQR(){let e="",t=document.getElementById("qrColorFG").value||"#000000",l=document.getElementById("qrColorBG").value||"#ffffff",r=document.getElementById("socialCardToggle").checked;if("url"===currentQrType)e=document.getElementById("qrInputUrl").value||"https://www.idcardscannerpro.com";else if("text"===currentQrType)e=document.getElementById("qrInputText").value||"Hello!";else if("wifi"===currentQrType){let n;e="WIFI:S:"+(document.getElementById("qrWifiName").value||"WiFi")+";T:WPA;P:"+(document.getElementById("qrWifiPass").value||"")+";;"}else if("email"===currentQrType){let o;e="MATMSG:TO:"+(document.getElementById("qrEmailTo").value||"mail@example.com")+";SUB:"+(document.getElementById("qrEmailSub").value||"Hello")+";BODY:;;"}let a=document.getElementById("qrFinalLayout"),d=document.getElementById("socialText");r?(a.style.background=l,a.style.border="4px solid "+t,d.style.display="block",d.style.color=t):(a.style.background="transparent",a.style.border="none",d.style.display="none");let y=document.getElementById("qrcodeCanvas");if(y){y.innerHTML="";try{new QRCode(y,{text:e,width:180,height:180,colorDark:t,colorLight:l,correctLevel:QRCode.CorrectLevel.H})}catch(c){console.error("QR Library Error:",c)}}}function downloadAdvancedQR(){let e=document.getElementById("qrExportWrapper");"undefined"!=typeof html2canvas?html2canvas(e,{backgroundColor:null,scale:3}).then(e=>{let t=document.createElement("a");t.download="Pro_QRCode.png",t.href=e.toDataURL("image/png"),t.click()}):alert("Library html2canvas not loaded!")}function resetQR(){document.querySelectorAll("#qrInputFields input, #qrInputFields textarea").forEach(e=>e.value=""),document.getElementById("qrColorFG").value="#000000",document.getElementById("qrColorBG").value="#ffffff",document.getElementById("socialCardToggle").checked=!1;let e=document.getElementById("tab-url");e&&switchQrType("url",e),generateAdvancedQR(),console.log("QR Generator Reset Successfully!")}
