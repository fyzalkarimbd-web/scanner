let currLiveRateValue=null,currLanguage="bn";const currTranslations={bn:{title:"<i class='fa-solid fa-money-bill-transfer'></i> ডলার ⇄ টাকা কনভার্টার",type:"<i class='fa-solid fa-layer-group'></i> কনভার্ট ধরন:",amount:"<i class='fa-solid fa-calculator'></i> পরিমাণ লিখুন:",btn:"কনভার্ট করুন!",live:"<span class='pulse-icon' style='display:inline-block; margin-right:10px;'></span> আজকের লাইভ ডলার রেট:",res:"<i class='fa-solid fa-square-poll-vertical'></i> আপডেট রেট:",copy:"রেট কপি করুন!",copied:"কপি করা হয়েছে!",loading:"লোড হচ্ছে...",error:"রেট লোড করা যায়নি!",unitTaka:" টাকা ",unitPoisha:" পয়সা।",unitDollar:" ডলার।",optUsd:"ডলার ➔ টাকা",optBdt:"টাকা ➔ ডলার",valError:"দয়া করে আগে পরিমাণ লিখুন!",usdLabel:"১ ডলার"},en:{title:"<i class='fa-solid fa-money-bill-transfer'></i> Dollar ⇄ Taka Converter",type:"<i class='fa-solid fa-layer-group'></i> Conversion Type:",amount:"<i class='fa-solid fa-calculator'></i> Enter Amount:",btn:"Convert Now!",live:"<span class='pulse-icon' style='display:inline-block; margin-right:10px;'></span> Today's Live Exchange Rate:",res:"<i class='fa-solid fa-square-poll-vertical'></i> Updated Result:",copy:"Copy Result!",copied:"Copied!",loading:"Loading...",error:"Rate Load Failed!",unitTaka:" Taka ",unitPoisha:" Poisha.",unitDollar:" Dollar.",optUsd:"USD to BDT",optBdt:"BDT to USD",valError:"Please enter a valid amount first!",usdLabel:"1 USD"}};function formatLangNum(e){if("en"===currLanguage)return e.toString();let t={0:"০",1:"১",2:"২",3:"৩",4:"৪",5:"৫",6:"৬",7:"৭",8:"৮",9:"৯"};return e.toString().replace(/[0-9]/g,function(e){return t[e]})}function openCurrencyModal(){"function"==typeof setActiveMode&&setActiveMode("mode-currency"),document.getElementById("currencyModal").style.display="flex",document.body.style.overflow="hidden",loadLiveCurrency()}function closeCurrencyModal(){document.getElementById("currencyModal").style.display="none",document.body.style.overflow="auto",document.getElementById("currAmount").value="",document.getElementById("currResult").innerText="--"}function switchCurrLang(e){currLanguage=e,document.getElementById("lang-bn").classList.toggle("active","bn"===e),document.getElementById("lang-en").classList.toggle("active","en"===e);let t=currTranslations[e];document.getElementById("curr-title").innerHTML=t.title,document.getElementById("lbl-type").innerHTML=t.type,document.getElementById("lbl-amount").innerHTML=t.amount,document.getElementById("btn-text").innerText=t.btn,document.getElementById("lbl-live").innerHTML=t.live,document.getElementById("lbl-res").innerHTML=t.res,document.getElementById("copy-text").innerText=t.copy,document.getElementById("opt-usd-bdt").innerText=t.optUsd,document.getElementById("opt-bdt-usd").innerText=t.optBdt,currLiveRateValue?(updateLiveRateDisplay(),"--"!==document.getElementById("currResult").innerText&&convertCurrency()):document.getElementById("currLiveRate").innerText=t.loading}async function loadLiveCurrency(){let e=document.getElementById("currLiveRate");try{let t=await fetch("https://open.er-api.com/v6/latest/USD"),r=await t.json();currLiveRateValue=r.rates.BDT,updateLiveRateDisplay()}catch(n){e.innerText=currTranslations[currLanguage].error}}function updateLiveRateDisplay(){let e=currTranslations[currLanguage],t=currLiveRateValue,r=Math.floor(t);document.getElementById("currLiveRate").innerText=`${e.usdLabel} = ${formatLangNum(r)}${e.unitTaka}${formatLangNum(Math.round((t-r)*100))}${e.unitPoisha}`}function convertCurrency(){let e=document.getElementById("currAmount").value,t=parseFloat(e),r=document.getElementById("currDirection").value,n=document.getElementById("currResult"),a=currTranslations[currLanguage];if(!e||t<=0){"function"==typeof showAlert?showAlert(a.valError):alert(a.valError);return}if(!currLiveRateValue){"function"==typeof showAlert&&showAlert(a.error);return}let l="";if("usd-bdt"===r){let i=t*currLiveRateValue,o=Math.floor(i);l=`${formatLangNum(o.toLocaleString())}${a.unitTaka}${formatLangNum(Math.round((i-o)*100))}${a.unitPoisha}`}else{let u=t/currLiveRateValue;l=`${formatLangNum(u.toFixed(2))}${a.unitDollar}`}n.innerText=l}function copyCurrResult(){let e=document.getElementById("currResult").innerText,t=document.getElementById("copy-text");"--"!==e&&navigator.clipboard.writeText(e).then(()=>{let e=t.innerText;t.innerText=currTranslations[currLanguage].copied,setTimeout(()=>{t.innerText=e},1500)})}
