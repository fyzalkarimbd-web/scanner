let ipSelectedFiles=[];function openImgToPdfModal(){"function"==typeof setActiveMode&&setActiveMode("mode-img-to-pdf");var e=document.getElementById("imgToPdfModal");e&&(e.style.display="flex",document.body.style.overflow="hidden")}function closeImgToPdfModal(){var e=document.getElementById("imgToPdfModal");e&&(e.style.display="none",document.body.style.overflow="auto")}function updateIpPreview(){let e=document.getElementById("ipPreviewGrid"),t=document.getElementById("ipStatus");if(e.innerHTML="",0===ipSelectedFiles.length){e.innerHTML="<div style='grid-column: 1/-1; padding: 20px; color: #94a3b8;'>No images selected yet.</div>",t.textContent="Ready to convert";return}ipSelectedFiles.forEach((t,i)=>{let n=new FileReader;n.onload=t=>{let n=document.createElement("div");n.className="ip-preview-item",n.innerHTML=`
                <img src="${t.target.result}"/>
                <button class="ip-remove-btn" onclick="removeIpImage(${i})">&#215;</button>
            `,e.appendChild(n)},n.readAsDataURL(t)}),t.textContent=`${ipSelectedFiles.length} images selected.`}function removeIpImage(e){ipSelectedFiles.splice(e,1),updateIpPreview()}function clearIpTool(){if(0===ipSelectedFiles.length){"function"==typeof showAlert&&showAlert("No images to clear!");return}ipSelectedFiles=[],document.getElementById("ipFileInput").value="",updateIpPreview()}async function generateImagesToPdf(){if(0===ipSelectedFiles.length){"function"==typeof showAlert?showAlert("Please select or drag images first!"):alert("Please select or drag images first!");return}let e=document.getElementById("ipConvertBtn"),t=document.getElementById("ipStatus");parseFloat(document.getElementById("ipQuality").value),e.disabled=!0,e.innerHTML='<i class="fa-solid fa-circle-notch fa-spin"></i> Converting...',t.textContent="Processing images... Please wait.";try{let{jsPDF:i}=window.jspdf,n=new i({orientation:"p",unit:"mm",format:"a4"}),l=n.internal.pageSize.getWidth(),o=n.internal.pageSize.getHeight();for(let a=0;a<ipSelectedFiles.length;a++){let d=ipSelectedFiles[a],r=await readFileAsDataURL(d),s=await getImageDimensions(r),c=l/s.w,g=o/s.h,p=Math.min(c,g),f=s.w*p,m=s.h*p,u=(l-f)/2,y=(o-m)/2;a>0&&n.addPage(),n.addImage(r,"JPEG",u,y,f,m,void 0,"FAST",0),t.textContent=`Processing: ${a+1} of ${ipSelectedFiles.length}`}n.save("Converted_Images_Pro.pdf"),t.textContent="Conversion Successful!"}catch(v){console.error(v),t.textContent="Error occurred.","function"==typeof showAlert&&showAlert("Something went wrong!")}finally{e.disabled=!1,e.innerHTML='<i class="fa-solid fa-file-pdf"></i> Convert to PDF'}}function readFileAsDataURL(e){return new Promise((t,i)=>{let n=new FileReader;n.onload=()=>t(n.result),n.onerror=i,n.readAsDataURL(e)})}function getImageDimensions(e){return new Promise(t=>{let i=new Image;i.onload=()=>t({w:i.width,h:i.height}),i.src=e})}document.getElementById("ipFileInput").addEventListener("change",function(e){let t=Array.from(e.target.files);t.length>0&&(ipSelectedFiles=ipSelectedFiles.concat(t),updateIpPreview())});
